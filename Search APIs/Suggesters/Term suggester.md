# Term suggester（分词建议器）

`term`建议器基于编辑距离来建议分词。建议分词之前先分析提供的建议文本。每个经过分析的建议文本分词都提供建议分词。`term`建议器不会将查询考虑为请求的一部分。

## 常用的建议选项

|选项|说明|
|---|----|
|`text`|建议文本。建议文本是必须的选项，需要在全局或者每个建议请求中设置。|
|`field`|获取候选建议的来源字段。这是必须的字段，需要在全局或者每个建议请求中设置。|
|`analyzer`|分析建议文本的分析器。默认是建议字段的搜索分析器|
|`size`|每个建议文本分词返回的最大更正值。|
|`sort`|定义每个建议文本分词的建议如何排序。有两个可能的值：<br> - `score`: 首先用分值来排序，接着是文本频率，再用分词本身。<br> - `frequency`: 首先用文档频率，接着用相似性分值，再用分词本身。|
|`suggest_mode`|建议模式。控制包含什么建议，或者控制应该建议什么建议文本分词和建议。可以指定3个可能值：<br> - `missing`: 只建议不在索引中的建议文本分词<br> - `popular`: 只建议在原始建议文本分词以外的文件中的建议<br> - `always`: 根据建议文字中的字词建议任何相符的建议。|

## 额外的分词建议选项：

|选项|说明|
|---|---|
|`lowercase_terms`|文本分析之后将建议文本分词转变为小写|
|`max_edits`|候选建议可以有的最大的编辑距离，为了被认为是建议。只能是介于1和2之间的值。任何其他值都会抛出异常。默认是2|
|`prefix_length`|为了作为候选建议，必须匹配的最少前缀字符。默认是1.增加该值可以提高拼写检查性能。 通常拼写错误不会出现在分词的开头。（旧名称"prefix_len"已废弃）|
|`min_word_length`|建议文本分词必须具有的最小长度。默认是4.（旧名称"min_word_len"已废弃）|
|`shard_size`|设置每个分片中检索的建议的最大数量。在reduce阶段，基于`size`选项返回top N个建议。默认为`size`选项。将该值设置为大于`size`的值是有用的，以性能为代价来获取更精确的文档频率用于拼写校正。由于分词在分片间是分割的，拼写校正的文档频率可能不准确。增加`shard_size`可以使文档频率变得更准确。|
|`max_inspections`|乘以`shards_size`在分片级别上检查更多的候选拼写校正。以性能为代价提高精度。默认是5|
|`min_doc_freq`|建议在文档中必须出现的最小阈值。可以指定为一个绝对值或者文档数量的相对百分比。通过只建议高频分词来提高建议的质量。默认是0，未启用。如果指定了大于1的值，数字不可以是小数。分片级别的文档频率用于此选项。|
|`max_term_freq`|建议文档分词存在于文档中的最大阈值。可以是一个相对百分数（比如`0.4`）或者一个绝对值来表示文档频率。默认是`0.01f`。这可以用来在拼写检查中排除高频分词。高频分词通常拼写正确，这也提高了拼写检查的性能。分片级别的文档频率用于此选项。|
|`string_distance`|哪种字符串距离用于比较建议分词的相似度。可以指定5种可能的值：<br>-`internal`: 默认基于`damerau_levenshtein`，但是被高度优化用于比较索引中分词的字符串距离。<br>-`damerau_levenshtein`: 基于`Dameray-Levenshtein`算法的字符串距离算法。<br>-`levenstein`: 基于`Levenstein`编辑距离算法的字符串距离算法。<br>-`jarowinkler`基于`Jaro-Winkler`算法的字符串距离算法。<br>-`ngram`基于字符`n-grams`的字符串距离算法|
